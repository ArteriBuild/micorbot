{/* Copyright (c) 2021 AWE ***************************************************
'*  Name:        global.scaler.min.js 
'*  Description: Global javascipt snippet.
'*  Email:       wilson.wampers@gmail.com
'*****************************************************************************
'*  Modification History:
'*  -When           -Who            -Bug#           -What
'*  --------------------------------------------------------------------------
'*	-29-Sep-2021    -Wilson Wampers -               -Initial Version
'****************************************************************************/
/* LM: ww.22122.1221_T */}

var gs = gs || {};

// Launch special scripts
gs.debug         = false;
gs.verbose       = false;
gs.autoTCon      = false;
// Normal logic
gs.isActive      = false;
gs.meat          = false;
gs.dairy         = false;
gs.plants        = false;
gs.fish          = false;
gs.lae           = false;
gs.eggs          = false;
gs.npg           = false;
gs.organics      = false;
gs.triggerWidth  = 575;
gs.plantsTrigger = 520;
gs.arLi          = new Array();
gs.nliHelp       = 0;
gs.observe       = null;
gs.tools         = null;

gs.sHref = window.location.href.toLowerCase();

if(     gs.sHref.indexOf('/meat/') != -1 )          gs.meat = true;
else if(gs.sHref.indexOf('/dairy/') != -1 )         gs.dairy = true;
else if(gs.sHref.indexOf('/plants/') != -1 )        gs.plants = true;
else if(gs.sHref.indexOf('/fish/') != -1 )          gs.fish = true;
else if(gs.sHref.indexOf('/live-animals/') != -1 )  gs.lae = true;
else if(gs.sHref.indexOf('/eggs/') != -1 )          gs.eggs = true;
else if(gs.sHref.indexOf('/npg/') != -1 )           gs.npg = true;
else if(gs.sHref.indexOf('/organics/') != -1 )      gs.organics = true;

//****************************************************************************
// Desc: IE replacement observer for object resizing
//****************************************************************************
gs.observe = function() 
{
    gs.checkCommoditiesMenu($(window).width());
}

//****************************************************************************
// Desc: Object resize observer [console.log('Element:', entry.target);]
//****************************************************************************
try 
{
    gs.ro = new ResizeObserver(function(entries)
    {
        for(var entry in entries) 
        {
            var cr = entry.contentRect;

            gs.checkCommoditiesMenu( $(window).width() );
        }
    });
} catch(e) {;}

//****************************************************************************
// Desc: 
//****************************************************************************
gs.init = function()
{
    $(document).ready(
    function()
    {
        gs.tools = $('ul#tools').outerHTML();
    });
}

//****************************************************************************
// Desc: 
//****************************************************************************
gs.checkCommoditiesMenu = function(pnWidth)
{
    if(gs.arLi.length == 0)
    {
        var ni=0;

        $('ul#tools > li').each(function()
        {
            ni++;
            if($(this).prop('id') == 'liHelp')
            {
                gs.nliHelp = ni;
                if(gs.debug) console.log(':: li Help @ position: ' + gs.nliHelp);
            }
            if($(this).prop('id') == 'search-links-logout' 
            && $(this).html().length != 0) gs.hasLogOut = true;
            // Build array for later actions
            gs.arLi[gs.arLi.length] = $(this).html();
        });
    }
    if(gs.verbose) console.log('## check commodities menu @ screen-width --> ' + pnWidth + '\nPlants: ' + gs.plants);
    if(pnWidth <= gs.triggerWidth)
    { 
        gs.reformCommoditiesMenu(pnWidth);
        gs.reformDisclaimer(pnWidth);
    }
    else
    {
        gs.restoreCommoditiesMenu(pnWidth);
        gs.restoreDisclaimer(pnWidth);
    }
}

//****************************************************************************
// Desc: 
//****************************************************************************
gs.reformCommoditiesMenu = function(pnWidth)
{
    if(!gs.isActive)
    {
        if(gs.debug) console.log('## Reform of commodities menu @ screen-width --> ' + pnWidth);
        var ni=0, sHtml='';

        $('ul#tools > li').each(function()
        {
            ni++;
            if(ni>=gs.nliHelp) 
            {
                $(this).html('');
            }
        });

        if(gs.sHref.indexOf('/default.aspx') == -1 && gs.hasLogOut && (gs.lae || gs.meat))
        {// Add second menuBar in case of Logout button
            sHtml += '\n<ul class="_2ndMBar">';
            sHtml += '<li class="nLi2">';
            sHtml += '<a id="ctl00_PlaceHolderMain_searchLogout" href="/_layouts/15/SignOut.aspx"> Logout </a>';
            sHtml += '</li>';
            sHtml += '<li class="onePxl"></li>';
            sHtml += '<li class="nLi2" style="background-color: #a9b400;">';
            sHtml += '<a href="/pages/help.aspx" style="background-color: transparent; color: #000; font-weight: bold;">Help</a>';
            sHtml += '</li>';
            sHtml += '\n</ul>';

            $('div.commodity-menu').append(sHtml);
            if(gs.debug) console.log('Appended: \n' + sHtml);
        }
        else
        {// Add second menuBar in case of Register and Login
            if(gs.meat)
            {
                sHtml += '\n<ul class="_2ndMBar">';
                sHtml += `<li class="nLi3">
                            <a class="access" href="/Meat/Pages/Apply-for-meat-access.aspx">Register</a>
                        </li>`;
                sHtml += '</li>';
                sHtml += '<li class="onePxl"></li>';
                sHtml += `<li class="nLi3">
                            <a class="login" href="/Meat/Pages/meat.aspx">Login</a>
                          </li>`;
                sHtml += '<li class="onePxl"></li>';
                sHtml += '<li class="nLi3" style="background-color: #a9b400;">';
                sHtml += '<a href="/pages/help.aspx" style="background-color: transparent; color: #000; font-weight: bold;">Help</a>';
                sHtml += '</li>';
                sHtml += '\n</ul>';
            }
            else if(gs.lae)
            {
                sHtml += '\n<ul class="_2ndMBar">';
                sHtml += `<li class="nLi3">
                            <a class="access" href="/live-animals/Pages/Apply-for-live-animal-access.aspx">Register</a>
                        </li>`;
                sHtml += '</li>';
                sHtml += '<li class="onePxl"></li>';
                sHtml += `<li class="nLi3">
                            <a class="login" href="/live-animals/Pages/live_animals.aspx">Login</a>
                          </li>`;
                sHtml += '<li class="onePxl"></li>';
                sHtml += '<li class="nLi3" style="background-color: #a9b400;">';
                sHtml += '<a href="/pages/help.aspx" style="background-color: transparent; color: #000; font-weight: bold;">Help</a>';
                sHtml += '</li>';
                sHtml += '\n</ul>';
            }
            else if(gs.dairy || gs.fish || gs.eggs || gs.npg || gs.organics || gs.plants)
            {// Add second menuBar in case of Logout button
                sHtml += '\n<ul class="_2ndMBar">';
                sHtml += '<li class="nLi2">';
                sHtml += '<a class="emptyLi" name="emptyLi"></a>';
                sHtml += '</li>';
                sHtml += '<li class="onePxl"></li>';
                sHtml += '<li class="nLi2" style="background-color: #a9b400;">';
                sHtml += '<a href="/pages/help.aspx" style="background-color: transparent; color: #000; font-weight: bold;">Help</a>';
                sHtml += '</li>';
                sHtml += '\n</ul>';
            }

            $('div.commodity-menu').append(sHtml);
            if(gs.debug) console.log('Appended: \n' + sHtml);
        }

        gs.isActive = true;
    }
}

//****************************************************************************
// Desc: 
//****************************************************************************
gs.reformDisclaimer = function(pnWidth)
{
    if(!gs.disclaimerSet)
    {
        if(global.verbose) console.log('## Reform of disclaimer @ screen-width --> ' + pnWidth);
        var sHtml = '';
    
        sHtml += '<a class="chevron" title="Open/close the disclaimer section"></a>';
        if($('a.chevron').length == 0) $('div.content h2').append(sHtml);
    
        $('div.contentdisclaimer').on('mouseover', function()
        {
            $(this).css(
            {
                'background-color': 'rgba(0,49,81,.9)',
                cursor: 'pointer'
            });
        });
        $('div.contentdisclaimer').on('mouseout', function()
        {
            $(this).css(
            {
                'background-color': 'rgba(0,49,81,1)', 
                cursor: 'default'
            });
        });
        $('div.contentdisclaimer').on('mousedown', function(e)
        {
            switch(e.which)
            {
                case 1:
                    if($('div.content p').css('display') == 'none')
                    {
                        $('a.chevron').addClass('expanded');
                        $('div.content p').css({'display':'block'});
                        $('div.contentdisclaimer').css({height: 'auto'});
                    }
                    else
                    {
                        $('a.chevron').removeClass('expanded');
                        $('div.content p').css({'display':'none'});
                        $('div.contentdisclaimer').css({height: '50px'});
                    }
                break;
            }
        });

        gs.disclaimerSet = true;
    }
}

//****************************************************************************
// Desc: 
//****************************************************************************
gs.restoreCommoditiesMenu = function(pnWidth)
{
    if(gs.isActive)
    {
        $('div.commodity-menu').html('');
        $('div.commodity-menu').html(gs.tools);
        gs.isActive = false;
    }
}

//****************************************************************************
// Desc: 
//****************************************************************************
gs.restoreDisclaimer = function(pnWidth)
{
    if(global.verbose) console.log('## Restore of disclaimer @ screen-width --> ' + pnWidth);
    $('div.contentdisclaimer').off('mouseover');
    $('div.contentdisclaimer').off('mouseout');
    $('div.contentdisclaimer').off('mousedown'); 
    if($('a.chevron').length == 0) 
    {
        $('a.chevron').remove();
        $('div.content p').css({'display':''});
        $('div.contentdisclaimer').css({height: ''});
    } 
    else
    {
        $('div.content p').css({'display':''});
        $('div.contentdisclaimer').css({height: ''});
        if($('a.chevron').hasClass('expanded')) $('a.chevron').removeClass('expanded');
    }

    gs.disclaimerSet = false;  
}

//****************************************************************************
// Desc: 
//****************************************************************************
try
{
    gs.ro.observe(document.getElementById('aspnetForm'));
} 
catch(e) { ; }

//****************************************************************************
// Desc: 
//****************************************************************************
gs._Start = (function()
{
    gs.init();
})();

//****************************************************************************